---
import { ClientRouter } from 'astro:transitions';

import Navbar from '../components/ui/Navbar.astro';
import Head from '../components/Head.astro';

import { headingTypographyClasses } from '@/lib/layout/headingTypography';
import { getLayoutNavigation } from '@/lib/layout/layoutNavigation';
import { seo, template, analytics } from '../settings';
import Footer from '../components/ui/Footer.astro';

import '@/styles/fonts.css';
import '@/styles/layout.css';

type Props = {
  title?: string;
  description?: string;
  image?: string;
  showFooter?: boolean;
};

const {
  title = seo.default_title,
  description = seo.default_description,
  image = seo.default_image,
  showFooter = true,
} = Astro.props;

const { navItems, externalLinks } = await getLayoutNavigation();
---

<!doctype html>
<html lang="en" data-theme={template.darkTheme}>
  <head>
    {template.transitions && <ClientRouter />}

    <Head title={title} description={description} image={image} />
    {
      analytics.goatcounterEndpoint && (
        <script
          is:inline
          data-goatcounter={analytics.goatcounterEndpoint}
          async
          src="https://gc.zgo.at/count.js"
        />
      )
    }
  </head>
  <body
    class:list={{
      'font-sans antialiased': template.bodyFont === 'sans',
      'font-serif antialiased': template.bodyFont === 'serif',
    }}
  >
    <div class="site-shell bg-base-100 min-h-screen">
      <div id="page-top" aria-hidden="true"></div>
      <Navbar items={navItems} externalLinks={externalLinks} />
      <main
        class:list={[
          'mx-auto flex min-h-[calc(100vh-5rem)] w-full max-w-5xl flex-col gap-16 px-6 py-12 text-[1.05rem] leading-relaxed text-base-content/90',
          headingTypographyClasses,
        ]}
      >
        <slot />
        {showFooter && <Footer />}
      </main>
    </div>

    <script>
      import { initLayoutClient } from '@/lib/layout/layoutClient';

      initLayoutClient();
    </script>
  </body>
</html>
