---
import Layout from '@/layouts/Layout.astro';
import { highlightAuthor } from '@/lib/utils';
import { getCollection } from 'astro:content';

const papers = (await getCollection('papers'))
  .sort((a, b) => b.data.year - a.data.year)
  .map((paper) => ({
    title: paper.data.title,
    authors: paper.data.authors,
    venue: paper.data.venue,
    year: paper.data.year,
    link: paper.data.link ?? paper.data.pdf,
    abstract: paper.data.abstract,
  }));
---

<Layout title="Papers">
  <div class="prose max-w-none">
    <h1 class="text-3xl font-bold mb-8">Publications</h1>

    <div class="space-y-8">
      {
        papers.map((paper) => (
          <div class="card bg-base-200">
            <div class="card-body">
              {paper.link ? (
                <h2 class="card-title text-xl">
                  <a href={paper.link} class="hover:text-accent">
                    {paper.title}
                  </a>
                </h2>
              ) : (
                <h2 class="card-title text-xl">{paper.title}</h2>
              )}
              <p class="text-base mb-2">
                <span class="font-medium">Authors:</span>{' '}
                <span set:html={highlightAuthor(paper.authors)} />
              </p>
              <p class="text-sm mb-3">
                <span class="italic">{paper.venue}</span> â€¢ {paper.year}
              </p>
              {paper.abstract && (
                <p class="text-sm text-base-content/80">{paper.abstract}</p>
              )}
              {paper.link && (
                <div class="card-actions justify-end mt-4">
                  <a
                    href={paper.link}
                    class="btn btn-sm btn-secondary text-secondary-content"
                  >
                    Read Paper
                  </a>
                </div>
              )}
            </div>
          </div>
        ))
      }
    </div>
  </div>
</Layout>
