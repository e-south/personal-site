---
import Layout from '@/layouts/Layout.astro';
import List from '@/components/ui/List.astro';
import { getCollection } from 'astro:content';

const projects = (await getCollection('projects')).map((project) => ({
  title: project.data.title,
  description: project.data.description,
  image: project.data.image,
  imageAlt: project.data.imageAlt,
  featured: project.data.featured,
}));

const featuredProjects = projects
  .filter((project) => project.featured)
  .map(({ title, description, image, imageAlt }) => ({
    title,
    description,
    image,
    imageAlt,
  }));

const allProjects = projects.map(({ title, description, image, imageAlt }) => ({
  title,
  description,
  image,
  imageAlt,
}));
---

<Layout title="Projects">
  <div class="prose max-w-none">
    <h1 class="text-3xl font-bold mb-8">Projects</h1>

    {
      featuredProjects.length > 0 && (
        <section class="mb-12">
          <List listTitle="Featured Projects" listItems={featuredProjects} />
        </section>
      )
    }

    {
      allProjects.length > 0 && (
        <section>
          <List listTitle="All Projects" listItems={allProjects} />
        </section>
      )
    }
  </div>
</Layout>
